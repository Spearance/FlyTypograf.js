(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function t(e,t){a(e,t),t.add(e)}function n(e,t,n){a(e,t),t.set(e,n)}function a(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function i(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,l(e,t,"set"),n),n}function c(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,l(e,t,"get"))}function l(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var s=new WeakMap,o=new WeakMap,u=new WeakMap,p=new WeakMap,h=new WeakMap,g=new WeakMap,f=new WeakMap,v=new WeakMap,w=new WeakMap,d=new WeakSet,b=new WeakSet,m=new WeakSet,E=function(){function a(e,r){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),t(this,m),t(this,b),t(this,d),n(this,s,{writable:!0,value:""}),n(this,o,{writable:!0,value:""}),n(this,u,{writable:!0,value:0}),n(this,p,{writable:!0,value:"«"}),n(this,h,{writable:!0,value:"»"}),n(this,g,{writable:!0,value:{literals:{"1/2":"½","1/3":"⅓","1/4":"¼","1/5":"⅕","1/6":"⅙","1/7":"⅐","1/8":"⅛","1/9":"⅑","1/10":"⅒","2/3":"⅔","2/5":"⅖","3/4":"¾","3/5":"⅗","3/8":"⅜","4/5":"⅘","5/6":"⅚","5/8":"⅝","7/8":"⅞"},values:function(){return Object.values(this.literals).join("")}}}),n(this,f,{writable:!0,value:{literals:{0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","—":"⁻","+":"⁺","=":"⁼","(":"⁽",")":"⁾",o:"°",о:"°",'"':"″"},values:function(){return Object.values(this.literals).join("")}}}),n(this,v,{writable:!0,value:[{pattern:/\u00A0 | \u00A0/g,replace:"  "},{pattern:/\u202F | \u202F/g,replace:" "},{pattern:/[\u00A0\u202F]+/g,replace:" "},{pattern:/(?<![!-])--(?![->])/g,replace:function(e){return i(l,u,+c(l,u)-1),"-"}},{pattern:/([—–−])/g,replace:"-"}]}),n(this,w,{writable:!0,value:[{pattern:new RegExp("(?<= |^|\\d|[".concat(c(this,g).values(),"])-(?=\\d|[").concat(c(this,g).values(),"])"),"g"),replace:"−"},{pattern:/\+\/-/g,replace:function(){return i(l,u,c(l,u)-2),"±"}},{pattern:/(?<=(?:\d|[a-z])\s*)-:-/gi,replace:function(){return i(l,u,c(l,u)-2),"÷"}},{pattern:/(?<= |^|>|[^-!а-яёa-z0-9])-(?= |$|[^-])/gi,replace:"—"},{pattern:/(?<!^|["»:;.!?…, ]) —(?!-)/gm,replace:" —"},{pattern:/([ ]+)—([ ]*?)(["«a-zа-яё0-9])/gim,replace:function(e,t,n,a){return i(l,u,c(l,u)-((t.length?t.length-1:0)+(n.length?n.length-1:0)))," — ".concat(a)}},{pattern:/—(?=\d)/g,replace:"−"},{pattern:/\([cс]\)/gi,replace:function(){return i(l,u,c(l,u)-2),"©"}},{pattern:/\(r\)/gi,replace:function(){return i(l,u,c(l,u)-2),"®"}},{pattern:/\(tm\)/gi,replace:function(){return i(l,u,c(l,u)-3),"™"}},{pattern:/\(р\)/gi,replace:function(){return i(l,u,c(l,u)-2),"₽"}},{pattern:/(?<![.…])\.{3}(?!\.)/g,replace:function(){return i(l,u,c(l,u)-2),"…"}},{pattern:/…(\.+)/g,replace:function(e,t){return i(l,u,c(l,u)+2),"...".concat(t)}},{pattern:/(\d)[xх](\d)/gi,replace:"$1×$2"},{pattern:/\b([123457]\/(?:[2-9]|10))\b/g,replace:function(e,t){return c(l,g).literals["".concat(t)]&&i(l,u,c(l,u)-2),c(l,g).literals[t]?c(l,g).literals[t]:t}},{pattern:new RegExp("([".concat(c(this,g).values(),"])(\\d)"),"g"),replace:function(e,t,n){return i(l,u,c(l,u)+2),"".concat(Object.entries(c(l,g).literals).find((function(e){return e[1]===t}))[0]).concat(n)}},{pattern:/(\S)\^([0-9—+-=\(\)]|[oо"])/gi,replace:function(e,t,n){return i(l,u,+c(l,u)-1),"".concat(t).concat(c(l,f).literals[n]?c(l,f).literals[n]:n)}},{pattern:new RegExp("([".concat(c(this,f).values(),"])(?![ .])([0-9+-=()])"),"g"),replace:function(e,t,n){return"".concat(t).concat(c(l,f).literals[n])}},{pattern:new RegExp(" ([".concat(c(this,f).values(),"])"),"g"),replace:function(e,t){for(var n in c(l,f).literals)if(c(l,f).literals[n]===t)return" ".concat(n)}},{pattern:/["»](?=\S)/g,replace:c(this,p)},{pattern:/(?<=\S)["«]/g,replace:c(this,h)},{pattern:new RegExp('"('.concat(c(this,p),"[a-zа-яё0-9…])"),"ig"),replace:"".concat(c(this,p),"$1")},{pattern:new RegExp("([a-zа-яё0-9…?!]".concat(c(this,h),')"'),"ig"),replace:"$1".concat(c(this,h))},{pattern:new RegExp("([-a-z0-9]+=)[".concat(c(this,p)).concat(c(this,h),"]([^").concat(c(this,p)).concat(c(this,h),"]*?)"),"ig"),replace:'$1"$2'},{pattern:new RegExp('([-a-z0-9]+=)["]([^>'.concat(c(this,p)).concat(c(this,h),"]*?)[").concat(c(this,p)).concat(c(this,h),"]"),"ig"),replace:'$1"$2"'},{pattern:/\b'([std]|ve|ll|clock)\b/gi,replace:"’$1"},{pattern:new RegExp("([0-6]?[0-9])['′]([0-6]?[0-9])?(\\d+)[".concat(c(this,h),'"]'),"g"),replace:"$1′$2$3″"},{pattern:/((?:[ \u00A0]|>|^|\t)[a-zа-яё]{1,2}) /gim,replace:"$1 "},{pattern:/-(то|ка)\u00A0/gi,replace:"-$1 "},{pattern:/(?:\s|\t|[\u00A0 ])(же?|л[иь]|бы?|ка)([.,!?:;])?\u00A0/gi,replace:" $1$2 "}]}),this._element=e,this._isContentEditable=!0===this._element.contentEditable,r&&(i(this,p,r.leftOutQuote||"«"),i(this,h,r.rightOutQuote||"»"))}var l,E;return l=a,(E=[{key:"result",get:function(){return c(this,o)}},{key:"process",value:function(){i(this,o,this._element.value),r(this,d,y).call(this,c(this,v)),r(this,b,k).call(this),r(this,d,y).call(this,c(this,w)),this._element.value=c(this,o),r(this,m,$).call(this,c(this,u))}}])&&e(l.prototype,E),Object.defineProperty(l,"prototype",{writable:!1}),a}();function y(e){var t=this;e.forEach((function(e){i(t,o,c(t,o).replace(e.pattern,e.replace))}))}function k(){if(this._isContentEditable){this._element.focus();var e=document.getSelection().getRangeAt(0),t=e.cloneRange();return t.selectNodeContents(this._element),t.setEnd(_rang.endContainer,e.endOffset),t.toString().length}i(this,u,this._element.selectionStart)}function $(e){if(this._isContentEditable)return this._element.focus(),void document.getSelection().collapse(this._element,e);this._element.setSelectionRange(e,e)}var S=document.querySelector("#typograf"),x=new E(S);S.addEventListener("input",(function(){x.process()}));var _=document.querySelector("#highLight"),R=function(){var e=[];_.innerHTML="\n\t\t<p>\n\t\t\t".concat(S.value.replace(/\bon[a-z]+="?[^">]+"?/gi,"").replace(/="?javascript:/gi,'="#').replace(/(<\/?[a-z]+[^>]*?>)/gi,(function(t,n){return e.push(n),"<*>"})).replace(/\n{2,}/g,"</p><p>").replace(/\n/g,"<br />").replace(/\u00a0/g,'<span class="hlg">&nbsp;</span>').replace(/([…©®™₽×—–−„“«»″′’½⅓¼⅕⅙⅛⅔⅖¾⅗⅜⅘⅚⅝⅞±÷⁰¹²³⁴⁵⁶⁷⁸⁹⁻⁺⁼⁽⁾°]+)/gi,'<span class="hlb">$1</span>').replaceAll("<*>",(function(){var t=e[0];return e.splice(0,1),t})),"\n\t\t</p>\n\t")};S.addEventListener("keyup",R);var W=document.querySelector("#example").innerText,z=document.querySelector("#type"),M=null,j=function(){clearInterval(M),z.textContent="напечатать",M=null};z.addEventListener("click",(function(){if(M)j();else{S.value="",z.textContent="остановить";var e=0;M=setInterval((function(){var t=W.substring(0,e+1);S.value=t,e=S.value.length,x.process(),e<S.value.length&&(e=S.value.length),R(),t.length>=W.length&&j()}),100)}}))})();