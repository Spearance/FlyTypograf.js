!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var r in i)("object"==typeof exports?exports:e)[r]=i[r]}}(self,(()=>(()=>{"use strict";var e={d:(t,i)=>{for(var r in i)e.o(i,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>i});class i{#e="";#t=0;#i="«";#r="»";#a={literals:{"1/2":"½","1/3":"⅓","1/4":"¼","1/5":"⅕","1/6":"⅙","1/7":"⅐","1/8":"⅛","1/9":"⅑","1/10":"⅒","2/3":"⅔","2/5":"⅖","3/4":"¾","3/5":"⅗","3/8":"⅜","4/5":"⅘","5/6":"⅚","5/8":"⅝","7/8":"⅞"},values:function(){return Object.values(this.literals).join("")}};#s={literals:{0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","—":"⁻","+":"⁺","=":"⁼","(":"⁽",")":"⁾",o:"°",о:"°",'"':"″"},values:function(){return Object.values(this.literals).join("")}};#l=[{pattern:/\u00A0 | \u00A0/g,replace:"  "},{pattern:/\u202F | \u202F/g,replace:" "},{pattern:/[\u00A0\u202F]+/g,replace:" "},{pattern:/(?<![!-])--(?![->])/g,replace:()=>(this.#t--,"-")},{pattern:/([—–−])/g,replace:"-"}];#n=[{pattern:new RegExp(`(?<= |^|\\d|[${this.#a.values()}])-(?=\\d|[${this.#a.values()}])`,"g"),replace:"−"},{pattern:/\+\/-/g,replace:()=>(this.#t-=2,"±")},{pattern:/(?<=(?:\d|[a-z])\s*)-:-/gi,replace:()=>(this.#t-=2,"÷")},{pattern:/(?<= |^|>|[^-!а-яёa-z0-9])-(?= |$|[^-])/gi,replace:"—"},{pattern:/(?<!^|["»:;.!?…, ]) —(?!-)/gm,replace:" —"},{pattern:/([ ]+)—([ ]*?)(["«a-zа-яё0-9])/gim,replace:(e,t,i,r)=>(this.#t-=(t.length?t.length-1:0)+(i.length?i.length-1:0),` — ${r}`)},{pattern:/—(?=\d)/g,replace:"−"},{pattern:/\([cс]\)/gi,replace:()=>(this.#t-=2,"©")},{pattern:/\(r\)/gi,replace:()=>(this.#t-=2,"®")},{pattern:/\(tm\)/gi,replace:()=>(this.#t-=3,"™")},{pattern:/\(р\)/gi,replace:()=>(this.#t-=2,"₽")},{pattern:/(?<![.…])\.{3}(?!\.)/g,replace:()=>(this.#t-=2,"…")},{pattern:/…(\.+)/g,replace:(e,t)=>(this.#t+=2,`...${t}`)},{pattern:/(\d)[xх](\d)/gi,replace:"$1×$2"},{pattern:/\b([123457]\/(?:[2-9]|10))\b/g,replace:(e,t)=>(this.#a.literals[t]&&(this.#t-=2),this.#a.literals[t]?this.#a.literals[t]:t)},{pattern:new RegExp(`([${this.#a.values()}])(\\d)`,"g"),replace:(e,t,i)=>(this.#t+=2,`${Object.entries(this.#a.literals).find((e=>e[1]===t))[0]}${i}`)},{pattern:/(\S)\^([0-9—+-=()]|[oо"])/gi,replace:(e,t,i)=>(this.#t--,`${t}${this.#s.literals[i]?this.#s.literals[i]:i}`)},{pattern:new RegExp(`([${this.#s.values()}])(?![ .])([0-9+-=()])`,"g"),replace:(e,t,i)=>`${t}${this.#s.literals[i]}`},{pattern:new RegExp(` ([${this.#s.values()}])`,"g"),replace:(e,t)=>{for(let e in this.#s.literals)if(this.#s.literals[e]===t)return` ${e}`}},{pattern:/["»](?=\S)/g,replace:this.#i},{pattern:/(?<=\S)["«]/g,replace:this.#r},{pattern:new RegExp(`"(${this.#i}[a-zа-яё0-9…])`,"ig"),replace:`${this.#i}$1`},{pattern:new RegExp(`([a-zа-яё0-9…?!]${this.#r})"`,"ig"),replace:`$1${this.#r}`},{pattern:new RegExp(`([-a-z0-9]+=)[${this.#i}${this.#r}]([^${this.#i}${this.#r}]*?)`,"ig"),replace:'$1"$2'},{pattern:new RegExp(`([-a-z0-9]+=)["]([^>${this.#i}${this.#r}]*?)[${this.#i}${this.#r}]`,"ig"),replace:'$1"$2"'},{pattern:/\b'([std]|ve|ll|clock)\b/gi,replace:"’$1"},{pattern:new RegExp(`([0-6]?[0-9])['′]([0-6]?[0-9])?(\\d+)[${this.#r}"]`,"g"),replace:"$1′$2$3″"},{pattern:/((?:[ \u00A0]|>|^|\t)[a-zа-яё]{1,2}) /gim,replace:"$1 "},{pattern:/-(то|ка)\u00A0/gi,replace:"-$1 "},{pattern:/(?:\s|\t|[\u00A0 ])(же?|л[иь]|бы?|ка)([.,!?:;])?\u00A0/gi,replace:" $1$2 "}];constructor(e,t){this._element=e,this._isContentEditable=!0===this._element.contentEditable,t&&(this.#i=t.leftOutQuote||"«",this.#r=t.rightOutQuote||"»")}get result(){return this.#e}process(){this.#e=this._element.value,this.#o(this.#l),this.#o(this.#n)}#o(e){this.#t=this.#p(),e.forEach((e=>{this.#e=this.#e.replace(e.pattern,e.replace)})),this._element.value=this.#e,this.#u(this.#t)}#p(){if(this._isContentEditable){this._element.focus();let e=document.getSelection().getRangeAt(0),t=e.cloneRange();return t.selectNodeContents(this._element),t.setEnd(e.endContainer,e.endOffset),t.toString().length}return this._element.selectionStart}#u(e){if(this._isContentEditable)return this._element.focus(),void document.getSelection().collapse(this._element,e);this._element.setSelectionRange(e,e)}}return t})()));